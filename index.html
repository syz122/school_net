<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录 / 注册</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(120deg, #3498db, #8e44ad);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            width: min(25vw, 400px);
            height: min(50vh, 400px);
            position: relative;
            min-width: 300px;
        }

        .form-container {
            padding: 30px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .form-container h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #333;
            font-size: min(calc(1vw + 1vh + 0.5vmin), 24px);
        }

        .input-group {
            position: relative;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group input {
            flex: 1;
            width: 100%;
            padding: 12px;
            border: none;
            border-bottom: 2px solid #ddd;
            background: transparent;
            outline: none;
            font-size: min(calc(0.8vw + 0.8vh + 0.5vmin), 16px);
            transition: 0.3s;
        }

        .input-group input:focus {
            border-bottom-color: #3498db;
        }

        .btn {
            width: 100%;
            padding: 10px;
            background: #3498db;
            border: none;
            border-radius: 5px;
            color: white;
            font-size: min(calc(0.8vw + 0.8vh + 0.5vmin), 16px);
            cursor: pointer;
            transition: 0.3s;
        }

        .btn:hover {
            background: #2980b9;
        }

        .toggle-form {
            text-align: center;
            margin-top: 20px;
            font-size: min(calc(0.7vw + 0.7vh + 0.5vmin), 14px);
        }

        .toggle-form a {
            color: #3498db;
            text-decoration: none;
            cursor: pointer;
        }

        .form-container.login {
            display: block;
        }

        .form-container.register {
            display: none;
        }

        .send-code-btn {
            padding: 8px 12px;
            background: #3498db;
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
            transition: 0.3s;
        }

        .send-code-btn:hover {
            background: #2980b9;
        }

        .send-code-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .verify-phone-btn {
            padding: 8px 12px;
            background: #3498db;
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
            transition: 0.3s;
        }

        .verify-phone-btn:hover {
            background: #2980b9;
        }

        input:disabled {
            background: #f5f5f5;
            cursor: not-allowed;
        }

        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 登录表单 -->
        <div class="form-container login">
            <h2>登录</h2>
            <form id="loginForm">
                <div class="input-group">
                    <input type="tel" placeholder="手机号" required>
                </div>
                <div class="input-group">
                    <input type="password" placeholder="密码" required>
                </div>
                <button type="submit" class="btn">登录</button>
                <div class="toggle-form">
                    还没有账号？<a onclick="toggleForm('register')">立即注册</a>
                </div>
            </form>
        </div>

        <!-- 注册表单 -->
        <div class="form-container register">
            <h2>注册</h2>
            <form id="registerForm">
                <div class="input-group">
                    <input type="tel" id="phoneInput" placeholder="请输入手机号" required>
                    <button type="button" class="verify-phone-btn" onclick="verifyPhone()">验证手机号</button>
                </div>
                <div class="input-group">
                    <input type="email" id="emailInput" placeholder="请输入邮箱地址" required disabled>
                    <button type="button" class="send-code-btn" onclick="sendEmailCode()" disabled>发送验证码</button>
                </div>
                <div class="input-group">
                    <input type="text" id="emailCodeInput" placeholder="邮箱验证码" required maxlength="6" disabled>
                </div>
                <div class="input-group">
                    <input type="password" placeholder="密码" required disabled>
                </div>
                <div class="input-group">
                    <input type="password" placeholder="确认密码" required disabled>
                </div>
                <button type="submit" class="btn">注册</button>
                <div class="toggle-form">
                    已有账号？<a onclick="toggleForm('login')">立即登录</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        const ADMIN_USERNAME = 'wyjnszmd';
        const ADMIN_PASSWORD = 'syz040908';

        // 验证手机号格式
        function isValidPhone(phone) {
            const phoneRegex = /^1[3-9]\d{9}$/;
            return phoneRegex.test(phone);
        }

        // 切换登录和注册表单
        function toggleForm(formType) {
            const loginForm = document.querySelector('.form-container.login');
            const registerForm = document.querySelector('.form-container.register');
            
            if (formType === 'register') {
                loginForm.style.display = 'none';
                registerForm.style.display = 'block';
            } else {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            }
        }

        // 登录表单提交处理
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const phone = this.querySelector('input[type="tel"]').value;
            const password = this.querySelector('input[type="password"]').value;
            
            // 验证是否是管理员账号
            if (phone === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                alert('管理员登录成功！');
                window.location.href = 'admin.html';
            } else {
                // 非管理员账号，验证手机号格式
                if (!isValidPhone(phone)) {
                    alert('请输入正确的手机号格式！');
                    return;
                }
                // 提示注册
                alert('该账号未注册，请先注册！');
                toggleForm('register');
            }
        });

        // 添加密码验证函数
        function isValidPassword(password) {
            // 检查密码长度
            if (password.length < 8) {
                return {
                    isValid: false,
                    message: '密码长度必须大于8位'
                };
            }

            // 检查字母数量
            const letterCount = (password.match(/[a-zA-Z]/g) || []).length;
            if (letterCount < 3) {
                return {
                    isValid: false,
                    message: '密码必须包含至少3个字母'
                };
            }

            // 检查特殊符号
            const specialChars = ['!', '@', '#', '$', '%', '&', '*'];
            const hasSpecialChar = specialChars.some(char => password.includes(char));
            if (!hasSpecialChar) {
                return {
                    isValid: false,
                    message: '密码必须包含至少一个特殊符号（!@#$%&*）'
                };
            }

            return {
                isValid: true,
                message: '密码格式正确'
            };
        }

        // 添加邮箱验证相关函数
        let emailCodeTimer = null;
        const EMAIL_CODE_TIMEOUT = 60; // 验证码倒计时秒数

        function sendEmailCode() {
            const emailInput = document.getElementById('emailInput');
            const email = emailInput.value;
            
            if (!isValidEmail(email)) {
                alert('请输入正确的邮箱格式！');
                return;
            }

            const sendButton = document.querySelector('.send-code-btn');
            sendButton.disabled = true;
            
            // 模拟发送验证码
            console.log('发送验证码到邮箱:', email);
            
            // 开始倒计时
            let countdown = EMAIL_CODE_TIMEOUT;
            sendButton.textContent = `${countdown}秒后重试`;
            
            emailCodeTimer = setInterval(() => {
                countdown--;
                if (countdown <= 0) {
                    clearInterval(emailCodeTimer);
                    sendButton.disabled = false;
                    sendButton.textContent = '发送验证码';
                } else {
                    sendButton.textContent = `${countdown}秒后重试`;
                }
            }, 1000);
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // 修改注册表单处理
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const phone = this.querySelector('input[type="tel"]').value;
            const email = this.querySelector('input[type="email"]').value;
            const emailCode = this.querySelector('input[type="text"]').value;
            const password = this.querySelectorAll('input[type="password"]')[0].value;
            const confirmPassword = this.querySelectorAll('input[type="password"]')[1].value;
            
            // 验证邮箱
            if (!isValidEmail(email)) {
                alert('请输入正确的邮箱格式！');
                return;
            }

            // 验证验证码
            if (emailCode.length !== 6) {
                alert('请输入6位验证码！');
                return;
            }

            // 其他验证保持不变...
            if (phone === ADMIN_USERNAME) {
                alert('该账号已被使用，请使用其他账号！');
                return;
            }

            if (!isValidPhone(phone)) {
                alert('请输入正确的手机号格式！');
                return;
            }

            const passwordValidation = isValidPassword(password);
            if (!passwordValidation.isValid) {
                alert(passwordValidation.message);
                return;
            }

            if (password !== confirmPassword) {
                alert('两次输入的密码不一致！');
                return;
            }
            
            console.log('注册信息:', {phone, email, emailCode, password});
            alert('注册成功！请登录');
            toggleForm('login');
        });

        // 清理定时器
        window.addEventListener('beforeunload', () => {
            if (emailCodeTimer) {
                clearInterval(emailCodeTimer);
            }
        });

        // 在HTML中添加密码规则提示
        document.querySelector('.register .input-group input[type="password"]').addEventListener('focus', function() {
            const tipDiv = document.createElement('div');
            tipDiv.className = 'password-tips';
            tipDiv.style.color = '#666';
            tipDiv.style.fontSize = '12px';
            tipDiv.style.marginTop = '5px';
            tipDiv.innerHTML = `
                密码规则：<br>
                - 长度必须大于8位<br>
                - 至少包含3个字母<br>
                - 至少包含1个特殊符号（!@#$%&*）
            `;
            
            // 如果提示不存在才添加
            if (!this.parentNode.querySelector('.password-tips')) {
                this.parentNode.appendChild(tipDiv);
            }
        });

        // 当密码输入框失去焦点时移除提示
        document.querySelector('.register .input-group input[type="password"]').addEventListener('blur', function() {
            const tipDiv = this.parentNode.querySelector('.password-tips');
            if (tipDiv) {
                tipDiv.remove();
            }
        });

        // 添加手机号验证函数
        function verifyPhone() {
            const phoneInput = document.getElementById('phoneInput');
            const phone = phoneInput.value;
            
            if (!isValidPhone(phone)) {
                alert('请输入正确的手机号格式！');
                return;
            }
            
            if (phone === ADMIN_USERNAME) {
                alert('该手机号已被注册，请使用其他手机号！');
                return;
            }

            // 验证成功后启用其他输入框
            const emailInput = document.getElementById('emailInput');
            const emailCodeInput = document.getElementById('emailCodeInput');
            const passwordInputs = document.querySelectorAll('.register input[type="password"]');
            const sendCodeBtn = document.querySelector('.send-code-btn');
            
            emailInput.disabled = false;
            emailCodeInput.disabled = false;
            passwordInputs.forEach(input => input.disabled = false);
            sendCodeBtn.disabled = false;
            
            // 禁用手机号输入和验证按钮
            phoneInput.disabled = true;
            document.querySelector('.verify-phone-btn').disabled = true;
            
            alert('手机号验证成功，请继续填写其他信息！');
        }
    </script>
</body>
</html>
